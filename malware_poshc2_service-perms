
Finished starting job1,job2,job3,job4 -- Elapsed-Time: 0:00:00.015290

====================================================================================================
added pid 0 of                        background-process System Idle Process                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4 of                        background-process System                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 92 of                        background-process Registry                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 320 of                        background-process smss.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 436 of                        background-process csrss.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 512 of                        background-process wininit.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 520 of                        background-process csrss.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 576 of                        background-process winlogon.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 648 of                        background-process services.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 664 of                        background-process lsass.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 764 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1020 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1036 of                        background-process SearchIndexer.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1048 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1140 of                        background-process sshd.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1200 of                        background-process MemCompression                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1692 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1720 of                        background-process spoolsv.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1844 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2028 of                        background-process MsMpEng.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2108 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2500 of                        background-process SgrmBroker.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2860 of                        background-process uhssvc.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4108 of                        background-process SecurityHealthService.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4200 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 6340 of                        background-process svchost.exe                        with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 424 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1028 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1160 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1380 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1452 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1616 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1624 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1836 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2052 of                        background-process dasHost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2088 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2264 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2780 of                        background-process svchost.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 5872 of                        background-process audiodg.exe                        with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 884 of                        background-process svchost.exe                        with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 1384 of                        background-process svchost.exe                        with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 2572 of                        background-process svchost.exe                        with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
====================================================================================================
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6


spawned_shell_process 9368's parent-process is indeed the main-python-process python3.10.exe : 5112


Finished Blacklisting Main-Python-Process 5112

PS C:\malware> Trace-Command -Name metadata, parameterbinding, cmdlet -Expression {. "C:\Users\puma-4\Desktop\PoshC2-master\resources\modules\Service-Perms.ps1";Get-ServicePerms} -PSHost;
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [using System;

using System.Data;

using System.Collections.Generic;

using System.Diagnostics;

using System.IO;

using System.Text;

using System.Threading;

using System.Management;

using System.Text.RegularExpressions;

using System.Security.AccessControl;

using System.Security.Principal;

using System.Xml;

using System.Collections;

using System.ServiceProcess;

using System.Net;



public static class ServicePerms



    {

        static List<string> folderlist;

        public static void dumpfolderperms(List<string> folderlist, DataSet ds)

        {

            //DataSet ds = new DataSet();

            ds.Tables.Add("folders");

            ds.Tables["folders"].Columns.Add("Folder");

            ds.Tables["folders"].Columns.Add("Permissions");

            string permstring = null;

            string cpermstring = null; 



            foreach (string value in folderlist)

            {

                permstring = null;

                cpermstring = null;

                try

                {

                    FileSecurity fileSecurity = new FileSecurity(value, AccessControlSections.Access);

                    AuthorizationRuleCollection arc = fileSecurity.GetAccessRules(true, true, typeof(NTAccount));

                    foreach (FileSystemAccessRule rule in arc)

                    {



                        permstring = "";

                        permstring = rule.IdentityReference + " " + rule.AccessControlType + " " + 
rule.FileSystemRights;



                        // is this case sensitive

                        if (permstring.Contains("Users") & permstring.Contains("Modify"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Users") & permstring.Contains("FullControl"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Everyone") & permstring.Contains("Modify"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Everyone") & permstring.Contains("FullControl"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }



                        cpermstring = cpermstring + permstring + " <br>";



                    }



                    }

                    catch

                    {



                    }



                ds.Tables["folders"].Rows.Add(value, cpermstring);

            }

            String hostName = Dns.GetHostName();

            string contents = ConvertDataTableToHtml(ds.Tables["services"]);

            string contentsfolders = ConvertDataTableToHtml2(ds.Tables["folders"]);

            File.WriteAllText("Report-" + hostName + ".html", contents + contentsfolders);

        }



        public static void dumpservices()

        {

            String hostName = Dns.GetHostName();

            List<string> list = new List<string>();

            folderlist = new List<string>();

            //List<string> folderlist = new List<string>();

            DataSet ds = new DataSet();

            ds.Tables.Add("services");

            ds.Tables["services"].Columns.Add("Service Name");

            ds.Tables["services"].Columns.Add("Unquoted");

            ds.Tables["services"].Columns.Add("ImagePath");

            ds.Tables["services"].Columns.Add("Permissions");

            ds.Tables["services"].Columns.Add("Service Information");



            ObjectQuery query = new ObjectQuery("SELECT * FROM Win32_Service");

            ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);

            foreach (ManagementObject queryObj in searcher.Get())

            {

                String input = "";

                try {

                    if (queryObj["PathName"].ToString() == "") {

                    continue;

                    } else {

                    input = queryObj["PathName"].ToString();

                    }

                } catch {

                }

                string key = "";

                string unquoted = "";



                Match match = Regex.Match(input, @"^(.+?).exe", RegexOptions.IgnoreCase);



                // Here we check the Match instance.

                if (match.Success)

                {



                    //Check for unquotes service paths

                    string unqu = match.Groups[1].Value + ".exe";

                    if (!unqu.Contains("\"") && unqu.Contains(" "))

                    {

                        unquoted = "Unquoted**";

                    }

                    else

                    {

                        unquoted = "False";

                    }



                    // Finally, we get the Group value and display it.

                    key = match.Groups[1].Value + ".exe";

                    key = key.Replace("\"", "");

                    string permsstring = null;

                    string currentpermstring = null;

                    try

                    {

                        FileSecurity fileSecurity = new FileSecurity(key, AccessControlSections.Access);

                        var file_info = new FileInfo(key);

                        //file_info.Directory.Parent

                        

                        AuthorizationRuleCollection arc = fileSecurity.GetAccessRules(true, true, typeof(NTAccount));

                        foreach (FileSystemAccessRule rule in arc)

                        {

                            // find if users modify

                            // if it contains everyone or users with modify or fullControl then flag as bold or 
something.....

                            // or search through the html after.....

                            currentpermstring = "";

                            currentpermstring = rule.IdentityReference + " " + rule.AccessControlType + " " + 
rule.FileSystemRights;



                            // is this case sensitive

                            if (currentpermstring.Contains("Users") & currentpermstring.Contains("Modify"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Users") & currentpermstring.Contains("FullControl"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Everyone") & currentpermstring.Contains("Modify"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Everyone") & currentpermstring.Contains("FullControl"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }



                            permsstring = permsstring + currentpermstring + " <br>";



                        }

                    }

                    catch

                    {

                        permsstring = "Path not found: " + key + "\n";

                    }



                    var key2 = "";



                    Match match2 = Regex.Match(key, @"^(.*[\\\/])[^\\\/]*$", RegexOptions.IgnoreCase);



                    if (match2.Success)

                    {

                        key2 = match2.Groups[1].ToString();



                    }



                    

                    var file = new FileInfo(key);

                    var directory2 = file.Directory;



                    while (directory2 != null)

                    {



                        if (!folderlist.Contains(directory2.FullName.ToString().ToLower()))

                        {

                            folderlist.Add(directory2.FullName.ToString().ToLower());

                        }



                        directory2 = directory2.Parent;



                    }





                    string serviceinformation = "";

                    // Try and see if the service can be stopped or restarted

                    

                    ServiceController svc = new ServiceController(queryObj["Name"].ToString());

                    try

                    {

                        serviceinformation = svc.Status.ToString();

                        bool canstop = svc.CanPauseAndContinue;

                        bool canstart = svc.CanStop;

                        bool canshutdown = svc.CanShutdown;

                        serviceinformation = serviceinformation + "<br>CanPauseAndContinue:" + canstop + 
"<br>CanStart:" + canstart + "<br>CanShutdown:" + canshutdown;



                        //svc.Start();

                    }

                    catch (Exception ex)

                    {

                        Console.WriteLine("Error" + ex);

                    }



                    ds.Tables["services"].Rows.Add(queryObj["DisplayName"].ToString() + " (" + 
queryObj["Name"].ToString() + ")", unquoted, queryObj["PathName"].ToString(), permsstring, serviceinformation);

                }



            }

            DirSearch("C:\\");

            dumpfolderperms(folderlist, ds);



        }

        public static void DirSearch(string sDir)

        {

            try

            {

                foreach (string d in Directory.GetDirectories(sDir))

                {

                    folderlist.Add(d);

                    DirSearch(d);

                }

            }

            catch (System.Exception excpt)

            {

                Console.WriteLine(excpt.Message);

            }

        }

        public static string ConvertDataTableToHtml(DataTable targetTable)

        {

            if (targetTable == null)

            {

                throw new ArgumentNullException("targetTable");

            }

            StringBuilder builder = new StringBuilder();

            builder.Append("<html>");

            builder.Append("<head>");

            builder.Append("<title>");

            builder.Append("Page-");

            builder.Append(Guid.NewGuid().ToString());

            builder.Append("</title>");

            builder.Append("</head>");

            builder.Append("<body>");

            builder.Append("<h1>Service Permissions - Search for ** to find any vulnerabilities........</h1>");

            builder.Append("<table border='1px' cellpadding='5' cellspacing='0' ");

            builder.Append("style='border: solid 1px Black; font-size: small;'>");

            builder.Append("<tr align='left' valign='top'>");

            foreach (DataColumn column in targetTable.Columns)

            {

                builder.Append("<td align='left' valign='top'>");

                builder.Append(column.ColumnName);

                builder.Append("</td>");

            }

            builder.Append("</tr>");

            foreach (DataRow row in targetTable.Rows)

            {

                builder.Append("<tr align='left' valign='top'>");

                foreach (DataColumn column2 in targetTable.Columns)

                {

                    builder.Append("<td align='left' valign='top'>");

                    builder.Append(row[column2.ColumnName].ToString());

                    builder.Append("</td>");

                }

                builder.Append("</tr>");

            }

            builder.Append("</table>");

            builder.Append("</body>");

            builder.Append("</html>");

            return builder.ToString();

        }

        

        public static string ConvertDataTableToHtml2(DataTable targetTable)

        {

            if (targetTable == null)

            {

                throw new ArgumentNullException("targetTable");

            }

            StringBuilder builder = new StringBuilder();

            builder.Append("<html>");

            builder.Append("<head>");

            builder.Append("<title>");

            builder.Append("Page-");

            builder.Append(Guid.NewGuid().ToString());

            builder.Append("</title>");

            builder.Append("</head>");

            builder.Append("<body>");

            builder.Append("<table border='1px' cellpadding='5' cellspacing='0' ");

            builder.Append("style='border: solid 1px Black; font-size: small;'>");

            builder.Append("<tr align='left' valign='top'>");

            foreach (DataColumn column in targetTable.Columns)

            {

                builder.Append("<td align='left' valign='top'>");

                builder.Append(column.ColumnName);

                builder.Append("</td>");

            }

            builder.Append("</tr>");

            foreach (DataRow row in targetTable.Rows)

            {

                builder.Append("<tr align='left' valign='top'>");

                foreach (DataColumn column2 in targetTable.Columns)

                {

                    builder.Append("<td align='left' valign='top'>");

                    builder.Append(row[column2.ColumnName].ToString());

                    builder.Append("</td>");

                }

                builder.Append("</tr>");

            }

            builder.Append("</table>");

            builder.Append("</body>");

            builder.Append("</html>");

            return builder.ToString();

        }

}

] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [using System;

using System.Data;

using System.Collections.Generic;

using System.Diagnostics;

using System.IO;

using System.Text;

using System.Threading;

using System.Management;

using System.Text.RegularExpressions;

using System.Security.AccessControl;

using System.Security.Principal;

using System.Xml;

using System.Collections;

using System.ServiceProcess;

using System.Net;



public static class ServicePerms



    {

        static List<string> folderlist;

        public static void dumpfolderperms(List<string> folderlist, DataSet ds)

        {

            //DataSet ds = new DataSet();

            ds.Tables.Add("folders");

            ds.Tables["folders"].Columns.Add("Folder");

            ds.Tables["folders"].Columns.Add("Permissions");

            string permstring = null;

            string cpermstring = null; 



            foreach (string value in folderlist)

            {

                permstring = null;

                cpermstring = null;

                try

                {

                    FileSecurity fileSecurity = new FileSecurity(value, AccessControlSections.Access);

                    AuthorizationRuleCollection arc = fileSecurity.GetAccessRules(true, true, typeof(NTAccount));

                    foreach (FileSystemAccessRule rule in arc)

                    {



                        permstring = "";

                        permstring = rule.IdentityReference + " " + rule.AccessControlType + " " + 
rule.FileSystemRights;



                        // is this case sensitive

                        if (permstring.Contains("Users") & permstring.Contains("Modify"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Users") & permstring.Contains("FullControl"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Everyone") & permstring.Contains("Modify"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }

                        if (permstring.Contains("Everyone") & permstring.Contains("FullControl"))

                        {

                            permstring = "<b><div style=\"color:red;\">**" + permstring + "</div></b>";

                        }



                        cpermstring = cpermstring + permstring + " <br>";



                    }



                    }

                    catch

                    {



                    }



                ds.Tables["folders"].Rows.Add(value, cpermstring);

            }

            String hostName = Dns.GetHostName();

            string contents = ConvertDataTableToHtml(ds.Tables["services"]);

            string contentsfolders = ConvertDataTableToHtml2(ds.Tables["folders"]);

            File.WriteAllText("Report-" + hostName + ".html", contents + contentsfolders);

        }



        public static void dumpservices()

        {

            String hostName = Dns.GetHostName();

            List<string> list = new List<string>();

            folderlist = new List<string>();

            //List<string> folderlist = new List<string>();

            DataSet ds = new DataSet();

            ds.Tables.Add("services");

            ds.Tables["services"].Columns.Add("Service Name");

            ds.Tables["services"].Columns.Add("Unquoted");

            ds.Tables["services"].Columns.Add("ImagePath");

            ds.Tables["services"].Columns.Add("Permissions");

            ds.Tables["services"].Columns.Add("Service Information");



            ObjectQuery query = new ObjectQuery("SELECT * FROM Win32_Service");

            ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);

            foreach (ManagementObject queryObj in searcher.Get())

            {

                String input = "";

                try {

                    if (queryObj["PathName"].ToString() == "") {

                    continue;

                    } else {

                    input = queryObj["PathName"].ToString();

                    }

                } catch {

                }

                string key = "";

                string unquoted = "";



                Match match = Regex.Match(input, @"^(.+?).exe", RegexOptions.IgnoreCase);



                // Here we check the Match instance.

                if (match.Success)

                {



                    //Check for unquotes service paths

                    string unqu = match.Groups[1].Value + ".exe";

                    if (!unqu.Contains("\"") && unqu.Contains(" "))

                    {

                        unquoted = "Unquoted**";

                    }

                    else

                    {

                        unquoted = "False";

                    }



                    // Finally, we get the Group value and display it.

                    key = match.Groups[1].Value + ".exe";

                    key = key.Replace("\"", "");

                    string permsstring = null;

                    string currentpermstring = null;

                    try

                    {

                        FileSecurity fileSecurity = new FileSecurity(key, AccessControlSections.Access);

                        var file_info = new FileInfo(key);

                        //file_info.Directory.Parent

                        

                        AuthorizationRuleCollection arc = fileSecurity.GetAccessRules(true, true, typeof(NTAccount));

                        foreach (FileSystemAccessRule rule in arc)

                        {

                            // find if users modify

                            // if it contains everyone or users with modify or fullControl then flag as bold or 
something.....

                            // or search through the html after.....

                            currentpermstring = "";

                            currentpermstring = rule.IdentityReference + " " + rule.AccessControlType + " " + 
rule.FileSystemRights;



                            // is this case sensitive

                            if (currentpermstring.Contains("Users") & currentpermstring.Contains("Modify"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Users") & currentpermstring.Contains("FullControl"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Everyone") & currentpermstring.Contains("Modify"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }

                            if (currentpermstring.Contains("Everyone") & currentpermstring.Contains("FullControl"))

                            {

                                currentpermstring = "<b><div style=\"color:red;\">**" + currentpermstring + 
"</div></b>";

                            }



                            permsstring = permsstring + currentpermstring + " <br>";



                        }

                    }

                    catch

                    {

                        permsstring = "Path not found: " + key + "\n";

                    }



                    var key2 = "";



                    Match match2 = Regex.Match(key, @"^(.*[\\\/])[^\\\/]*$", RegexOptions.IgnoreCase);



                    if (match2.Success)

                    {

                        key2 = match2.Groups[1].ToString();



                    }



                    

                    var file = new FileInfo(key);

                    var directory2 = file.Directory;



                    while (directory2 != null)

                    {



                        if (!folderlist.Contains(directory2.FullName.ToString().ToLower()))

                        {

                            folderlist.Add(directory2.FullName.ToString().ToLower());

                        }



                        directory2 = directory2.Parent;



                    }





                    string serviceinformation = "";

                    // Try and see if the service can be stopped or restarted

                    

                    ServiceController svc = new ServiceController(queryObj["Name"].ToString());

                    try

                    {

                        serviceinformation = svc.Status.ToString();

                        bool canstop = svc.CanPauseAndContinue;

                        bool canstart = svc.CanStop;

                        bool canshutdown = svc.CanShutdown;

                        serviceinformation = serviceinformation + "<br>CanPauseAndContinue:" + canstop + 
"<br>CanStart:" + canstart + "<br>CanShutdown:" + canshutdown;



                        //svc.Start();

                    }

                    catch (Exception ex)

                    {

                        Console.WriteLine("Error" + ex);

                    }



                    ds.Tables["services"].Rows.Add(queryObj["DisplayName"].ToString() + " (" + 
queryObj["Name"].ToString() + ")", unquoted, queryObj["PathName"].ToString(), permsstring, serviceinformation);

                }



            }

            DirSearch("C:\\");

            dumpfolderperms(folderlist, ds);



        }

        public static void DirSearch(string sDir)

        {

            try

            {

                foreach (string d in Directory.GetDirectories(sDir))

                {

                    folderlist.Add(d);

                    DirSearch(d);

                }

            }

            catch (System.Exception excpt)

            {

                Console.WriteLine(excpt.Message);

            }

        }

        public static string ConvertDataTableToHtml(DataTable targetTable)

        {

            if (targetTable == null)

            {

                throw new ArgumentNullException("targetTable");

            }

            StringBuilder builder = new StringBuilder();

            builder.Append("<html>");

            builder.Append("<head>");

            builder.Append("<title>");

            builder.Append("Page-");

            builder.Append(Guid.NewGuid().ToString());

            builder.Append("</title>");

            builder.Append("</head>");

            builder.Append("<body>");

            builder.Append("<h1>Service Permissions - Search for ** to find any vulnerabilities........</h1>");

            builder.Append("<table border='1px' cellpadding='5' cellspacing='0' ");

            builder.Append("style='border: solid 1px Black; font-size: small;'>");

            builder.Append("<tr align='left' valign='top'>");

            foreach (DataColumn column in targetTable.Columns)

            {

                builder.Append("<td align='left' valign='top'>");

                builder.Append(column.ColumnName);

                builder.Append("</td>");

            }

            builder.Append("</tr>");

            foreach (DataRow row in targetTable.Rows)

            {

                builder.Append("<tr align='left' valign='top'>");

                foreach (DataColumn column2 in targetTable.Columns)

                {

                    builder.Append("<td align='left' valign='top'>");

                    builder.Append(row[column2.ColumnName].ToString());

                    builder.Append("</td>");

                }

                builder.Append("</tr>");

            }

            builder.Append("</table>");

            builder.Append("</body>");

            builder.Append("</html>");

            return builder.ToString();

        }

        

        public static string ConvertDataTableToHtml2(DataTable targetTable)

        {

            if (targetTable == null)

            {

                throw new ArgumentNullException("targetTable");

            }

            StringBuilder builder = new StringBuilder();

            builder.Append("<html>");

            builder.Append("<head>");

            builder.Append("<title>");

            builder.Append("Page-");

            builder.Append(Guid.NewGuid().ToString());

            builder.Append("</title>");

            builder.Append("</head>");

            builder.Append("<body>");

            builder.Append("<table border='1px' cellpadding='5' cellspacing='0' ");

            builder.Append("style='border: solid 1px Black; font-size: small;'>");

            builder.Append("<tr align='left' valign='top'>");

            foreach (DataColumn column in targetTable.Columns)

            {

                builder.Append("<td align='left' valign='top'>");

                builder.Append(column.ColumnName);

                builder.Append("</td>");

            }

            builder.Append("</tr>");

            foreach (DataRow row in targetTable.Rows)

            {

                builder.Append("<tr align='left' valign='top'>");

                foreach (DataColumn column2 in targetTable.Columns)

                {

                    builder.Append("<td align='left' valign='top'>");

                    builder.Append(row[column2.ColumnName].ToString());

                    builder.Append("</td>");

                }

                builder.Append("</tr>");

            }

            builder.Append("</table>");

            builder.Append("</body>");

            builder.Append("</html>");

            return builder.ToString();

        }

}

] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [CSharpVersion3] to parameter [Language]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [Microsoft.PowerShell.Commands.Language]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.String to 
Microsoft.PowerShell.Commands.Language
DEBUG: ParameterBinding Information: 0 :             CONVERT arg type to param type using LanguagePrimitives.ConvertTo
DEBUG: ParameterBinding Information: 0 :             CONVERT SUCCESSFUL using LanguagePrimitives.ConvertTo: 
[CSharpVersion3]
DEBUG: ParameterBinding Information: 0 :         BIND arg [CSharpVersion3] to param [Language] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [IgnoreWarnings]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [IgnoreWarnings] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [System.Object[]] to parameter [ReferencedAssemblies]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Object[] to 
System.String[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter ReferencedAssemblies: argument type 
[Object[]], parameter type [System.String[]], collection type Array, element type [System.String], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Arg is IList with 7 elements
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.String] and 7 elements
DEBUG: ParameterBinding Information: 0 :             Argument type System.Object[] is IList
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 0
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 1
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 2
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 3
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 4
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 5
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type System.String
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding element of type String to array position 6
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.String[]] to param [ReferencedAssemblies] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 9368 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

sleep now : for 300 seconds
wake up now : as 300 seconds past

Finished All Close-Traces-- Elapsed-Time: 0:00:00.015386

Started joinit for FILE
Finished joinit for FILE -- Elapsed-Time: 0:00:00
Started joinit for REGISTRY
Finished joinit for REGISTRY -- Elapsed-Time: 0:00:00.077989
Started joinit for NETWORK
Finished joinit for NETWORK -- Elapsed-Time: 0:00:00
Started joinit for PROCESS
Finished joinit for PROCESS -- Elapsed-Time: 0:00:00

Finished starting job1,job2,job3,job4 -- Elapsed-Time: 0:00:00.012949

====================================================================================================
added pid 0 of                                                background-process System Idle Process                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4 of                                                background-process System                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 92 of                                                background-process Registry                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 320 of                                                background-process smss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 436 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 512 of                                                background-process wininit.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 520 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 576 of                                                background-process winlogon.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 648 of                                                background-process services.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 664 of                                                background-process lsass.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 764 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1020 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1036 of                                                background-process SearchIndexer.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1048 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1140 of                                                background-process sshd.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1200 of                                                background-process MemCompression                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1692 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1720 of                                                background-process spoolsv.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1844 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2028 of                                                background-process MsMpEng.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2108 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2500 of                                                background-process SgrmBroker.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2860 of                                                background-process uhssvc.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4108 of                                                background-process SecurityHealthService.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4200 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 6340 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 424 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1028 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1160 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1380 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1452 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1616 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1624 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1836 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2052 of                                                background-process dasHost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2088 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2264 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2780 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 884 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 1384 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 2572 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
====================================================================================================

Finished Blacklisting Main-Python-Process 5112


*RESUMED the spwaned-powershell-process 9368

Access to the path 'C:\Program Files\Windows Defender Advanced Threat Protection\Classification\Configuration' is denied.
Access to the path 'C:\ProgramData\Application Data' is denied.
Access to the path 'C:\ProgramData\Desktop' is denied.
Access to the path 'C:\ProgramData\Documents' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows\SystemData' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender\DLPCache\SensitiveBuffer' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Cache' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Cyber' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DLP' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Downloads' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Platform' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\SenseCM' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\SenseNDR' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Temp\PSScriptOutputs' is denied.
Access to the path 'C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\Trace' is denied.
Access to the path 'C:\ProgramData\Packages\Microsoft.XboxGamingOverlay_8wekyb3d8bbwe\S-1-5-21-2334472832-2587113924-773976260-1001\SystemAppData\Helium' is denied.
Access to the path 'C:\ProgramData\Start Menu' is denied.
Access to the path 'C:\ProgramData\Templates' is denied.
Access to the path 'C:\System Volume Information' is denied.
Access to the path 'C:\Users\All Users\Application Data' is denied.
Access to the path 'C:\Users\All Users\Desktop' is denied.
Access to the path 'C:\Users\All Users\Documents' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows\SystemData' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender\DLPCache\SensitiveBuffer' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Cache' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Cyber' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\DataCollection' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\DLP' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Downloads' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Platform' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\SenseCM' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\SenseNDR' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Temp\PSScriptOutputs' is denied.
Access to the path 'C:\Users\All Users\Microsoft\Windows Defender Advanced Threat Protection\Trace' is denied.
Access to the path 'C:\Users\All Users\Packages\Microsoft.XboxGamingOverlay_8wekyb3d8bbwe\S-1-5-21-2334472832-2587113924-773976260-1001\SystemAppData\Helium' is denied.
Access to the path 'C:\Users\All Users\Start Menu' is denied.
Access to the path 'C:\Users\All Users\Templates' is denied.
Access to the path 'C:\Users\Default\AppData\Local\Application Data' is denied.
Access to the path 'C:\Users\Default\AppData\Local\History' is denied.
Access to the path 'C:\Users\Default\AppData\Local\Microsoft\Windows\Temporary Internet Files' is denied.
Access to the path 'C:\Users\Default\AppData\Local\Temporary Internet Files' is denied.
Access to the path 'C:\Users\Default\Application Data' is denied.
Access to the path 'C:\Users\Default\Cookies' is denied.
Access to the path 'C:\Users\Default\Documents\My Music' is denied.
Access to the path 'C:\Users\Default\Documents\My Pictures' is denied.
Access to the path 'C:\Users\Default\Documents\My Videos' is denied.
Access to the path 'C:\Users\Default\Local Settings' is denied.
Access to the path 'C:\Users\Default\My Documents' is denied.
Access to the path 'C:\Users\Default\NetHood' is denied.
Access to the path 'C:\Users\Default\PrintHood' is denied.
Access to the path 'C:\Users\Default\Recent' is denied.
Access to the path 'C:\Users\Default\SendTo' is denied.
Access to the path 'C:\Users\Default\Start Menu' is denied.
Access to the path 'C:\Users\Default\Templates' is denied.
Access to the path 'C:\Users\Default User' is denied.
Access to the path 'C:\Users\Public\Documents\My Music' is denied.
Access to the path 'C:\Users\Public\Documents\My Pictures' is denied.
Access to the path 'C:\Users\Public\Documents\My Videos' is denied.
Access to the path 'C:\Users\puma-4\AppData\Local\Application Data' is denied.
Access to the path 'C:\Users\puma-4\AppData\Local\History' is denied.
Access to the path 'C:\Users\puma-4\AppData\Local\Microsoft\Windows\INetCache\Content.IE5' is denied.
Access to the path 'C:\Users\puma-4\AppData\Local\Microsoft\Windows\Temporary Internet Files' is denied.
Access to the path 'C:\Users\puma-4\AppData\Local\Temporary Internet Files' is denied.
Access to the path 'C:\Users\puma-4\Application Data' is denied.
Access to the path 'C:\Users\puma-4\Cookies' is denied.
Access to the path 'C:\Users\puma-4\Documents\My Music' is denied.
Access to the path 'C:\Users\puma-4\Documents\My Pictures' is denied.
Access to the path 'C:\Users\puma-4\Documents\My Videos' is denied.
Access to the path 'C:\Users\puma-4\Local Settings' is denied.
Access to the path 'C:\Users\puma-4\My Documents' is denied.
Access to the path 'C:\Users\puma-4\NetHood' is denied.
Access to the path 'C:\Users\puma-4\PrintHood' is denied.
Access to the path 'C:\Users\puma-4\Recent' is denied.
Access to the path 'C:\Users\puma-4\SendTo' is denied.
Access to the path 'C:\Users\puma-4\Start Menu' is denied.
Access to the path 'C:\Users\puma-4\Templates' is denied.
Access to the path 'C:\Users\user\AppData\Local\Application Data' is denied.
Access to the path 'C:\Users\user\AppData\Local\History' is denied.
Access to the path 'C:\Users\user\AppData\Local\Microsoft\Windows\Temporary Internet Files' is denied.
Access to the path 'C:\Users\user\AppData\Local\Temporary Internet Files' is denied.
Access to the path 'C:\Users\user\Application Data' is denied.
Access to the path 'C:\Users\user\Cookies' is denied.
Access to the path 'C:\Users\user\Documents\My Music' is denied.
Access to the path 'C:\Users\user\Documents\My Pictures' is denied.
Access to the path 'C:\Users\user\Documents\My Videos' is denied.
Access to the path 'C:\Users\user\Local Settings' is denied.
Access to the path 'C:\Users\user\My Documents' is denied.
Access to the path 'C:\Users\user\NetHood' is denied.
Access to the path 'C:\Users\user\PrintHood' is denied.
Access to the path 'C:\Users\user\Recent' is denied.
Access to the path 'C:\Users\user\SendTo' is denied.
Access to the path 'C:\Users\user\Start Menu' is denied.
Access to the path 'C:\Users\user\Templates' is denied.
Access to the path 'C:\Windows\CSC' is denied.
Access to the path 'C:\Windows\ServiceProfiles\LocalService\AppData\Local\Microsoft\Ngc' is denied.
Access to the path 'C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Windows\INetCache\Content.IE5' is denied.
Access to the path 'C:\Windows\System32\LogFiles\WMI\RtBackup' is denied.
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Write-Output]
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Write-Output]
DEBUG: ParameterBinding Information: 0 : BIND REMAININGARGUMENTS cmd line args to param: [InputObject]
DEBUG: ParameterBinding Information: 0 :     BIND arg [System.Collections.Generic.List`1[System.Object]] to parameter 
[InputObject]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.PSObject[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from 
System.Collections.Generic.List`1[System.Object] to System.Management.Automation.PSObject[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter InputObject: argument type [List`1], 
parameter type [System.Management.Automation.PSObject[]], collection type Array, element type 
[System.Management.Automation.PSObject], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Arg is IList with 1 elements
DEBUG: ParameterBinding Information: 0 :             Creating array with element type 
[System.Management.Automation.PSObject] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type System.Collections.Generic.List`1[System.Object] is 
IList
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type 
System.Management.Automation.PSObject
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Management.Automation.PSObject]
DEBUG: ParameterBinding Information: 0 :                 Trying to convert argument value from System.String to 
System.Management.Automation.PSObject
DEBUG: ParameterBinding Information: 0 :                 The parameter is of type 
[System.Management.Automation.PSObject] and the argument is an PSObject, so the parameter value is the argument value 
wrapped into an PSObject.
DEBUG: ParameterBinding Information: 0 :             Adding element of type PSObject to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Management.Automation.PSObject[]] to param 
[InputObject] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Write-Output]
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 9368 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

sleep now : for 300 seconds
wake up now : as 300 seconds past

Finished All Close-Traces-- Elapsed-Time: 0:00:00

Started joinit for FILE
Finished joinit for FILE -- Elapsed-Time: 0:00:37.578132
Started joinit for REGISTRY
Finished joinit for REGISTRY -- Elapsed-Time: 0:00:00
Started joinit for NETWORK
Finished joinit for NETWORK -- Elapsed-Time: 0:00:00
Started joinit for PROCESS
Finished joinit for PROCESS -- Elapsed-Time: 0:00:00

Finished starting job1,job2,job3,job4 -- Elapsed-Time: 0:00:00

====================================================================================================
added pid 0 of                                                background-process System Idle Process                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4 of                                                background-process System                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 92 of                                                background-process Registry                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 320 of                                                background-process smss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 436 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 512 of                                                background-process wininit.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 520 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 576 of                                                background-process winlogon.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 648 of                                                background-process services.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 664 of                                                background-process lsass.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 764 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1020 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1036 of                                                background-process SearchIndexer.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1048 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1140 of                                                background-process sshd.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1200 of                                                background-process MemCompression                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1692 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1720 of                                                background-process spoolsv.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1844 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2028 of                                                background-process MsMpEng.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2108 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2500 of                                                background-process SgrmBroker.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2860 of                                                background-process uhssvc.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4108 of                                                background-process SecurityHealthService.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4200 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 6340 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 6592 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 424 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1028 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1160 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1380 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1452 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1616 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1624 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1836 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2052 of                                                background-process dasHost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2088 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2264 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2780 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 884 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 1384 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 2572 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 11240 of                                                background-process WmiPrvSE.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
====================================================================================================

Finished Blacklisting Main-Python-Process 5112


*RESUMED the spwaned-powershell-process 9368

DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Write-Output]
DEBUG: ParameterBinding Information: 0 : BIND REMAININGARGUMENTS cmd line args to param: [InputObject]
DEBUG: ParameterBinding Information: 0 :     BIND arg [System.Collections.Generic.List`1[System.Object]] to parameter 
[InputObject]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.PSObject[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from 
System.Collections.Generic.List`1[System.Object] to System.Management.Automation.PSObject[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter InputObject: argument type [List`1], 
parameter type [System.Management.Automation.PSObject[]], collection type Array, element type 
[System.Management.Automation.PSObject], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Arg is IList with 1 elements
DEBUG: ParameterBinding Information: 0 :             Creating array with element type 
[System.Management.Automation.PSObject] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type System.Collections.Generic.List`1[System.Object] is 
IList
DEBUG: ParameterBinding Information: 0 :             COERCE collection element from type String to type 
System.Management.Automation.PSObject
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Management.Automation.PSObject]
DEBUG: ParameterBinding Information: 0 :                 Trying to convert argument value from System.String to 
System.Management.Automation.PSObject
DEBUG: ParameterBinding Information: 0 :                 The parameter is of type 
[System.Management.Automation.PSObject] and the argument is an PSObject, so the parameter value is the argument value 
wrapped into an PSObject.
DEBUG: ParameterBinding Information: 0 :             Adding element of type PSObject to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Management.Automation.PSObject[]] to param 
[InputObject] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Write-Output]
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 9368 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

sleep now : for 300 seconds
wake up now : as 300 seconds past

Finished All Close-Traces-- Elapsed-Time: 0:00:00

Started joinit for FILE
Finished joinit for FILE -- Elapsed-Time: 0:00:00
Started joinit for REGISTRY
Finished joinit for REGISTRY -- Elapsed-Time: 0:00:00
Started joinit for NETWORK
Finished joinit for NETWORK -- Elapsed-Time: 0:00:00
Started joinit for PROCESS
Finished joinit for PROCESS -- Elapsed-Time: 0:00:00

Finished starting job1,job2,job3,job4 -- Elapsed-Time: 0:00:00

====================================================================================================
added pid 0 of                                                background-process System Idle Process                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4 of                                                background-process System                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 92 of                                                background-process Registry                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 320 of                                                background-process smss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 436 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 512 of                                                background-process wininit.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 520 of                                                background-process csrss.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 576 of                                                background-process winlogon.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 648 of                                                background-process services.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 664 of                                                background-process lsass.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 764 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1020 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1036 of                                                background-process SearchIndexer.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1048 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1140 of                                                background-process sshd.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1200 of                                                background-process MemCompression                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1692 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1720 of                                                background-process spoolsv.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 1844 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2028 of                                                background-process MsMpEng.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2108 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2500 of                                                background-process SgrmBroker.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 2860 of                                                background-process uhssvc.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4108 of                                                background-process SecurityHealthService.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 4200 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 6340 of                                                background-process svchost.exe                                                with username NT AUTHORITY\SYSTEM to pid-blacklist.
added pid 424 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1028 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1160 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1380 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1452 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1616 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1624 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 1836 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2052 of                                                background-process dasHost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2088 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2264 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 2780 of                                                background-process svchost.exe                                                with username NT AUTHORITY\LOCAL SERVICE to pid-blacklist.
added pid 884 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 1384 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
added pid 2572 of                                                background-process svchost.exe                                                with username NT AUTHORITY\NETWORK SERVICE to pid-blacklist.
====================================================================================================

Finished Blacklisting Main-Python-Process 5112


*RESUMED the spwaned-powershell-process 9368

[+] Writing output to Report-DESKTOP-9LD827I.html
PS C:\malware> spawned_psh_process -- Ended before 1 hr ; with NO exception raised
Closing Last ETW-Session-Set

Finished All Close-Traces-- Elapsed-Time: 0:00:00

Started joinit for FILE
Finished joinit for FILE -- Elapsed-Time: 0:00:00
Started joinit for REGISTRY
Finished joinit for REGISTRY -- Elapsed-Time: 0:00:00
Started joinit for NETWORK
Finished joinit for NETWORK -- Elapsed-Time: 0:00:00
Started joinit for PROCESS
Finished joinit for PROCESS -- Elapsed-Time: 0:00:00
